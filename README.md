# DiffDrivePWM-ROS2-MotorController
A ROS2 package to drive 2 DC motors with PWM generated by Raspberry PI 4

## Overview 
* it is written in C++
* it controls two DC motors using PWM
* PWM is generated by the Raspberry Pi 4 itself, with pigpiod
* the electronics is a simple "H bridge" based on DRV8833 IC.
* it subscribes to the RSO2 topic /cmd_vel
* has three optional parameters:
  * wheels_distance
  * max_speed
  * timeout_duration

to test it, you can install it on Raspberry PI 4, using the following instructions.

## Prepare the Raspberry PI 4

### Install Ubuntu 22.04

ROS2 Humble requires Ubuntu 22.04

On your development computer, use Raspberry imager to create an SD card with 

![](docs/ubuntu.png)

### Install ROS2 Humble on the Raspberry PI 4

* Follow these instructions: https://docs.ros.org/en/humble/Installation/Ubuntu-Install-Debs.html
* When you arrive at "Install ROS 2 packages" install only:
  
  `sudo apt install ros-humble-ros-base`

  `sudo apt install ros-dev-tools`

   and stop there.

* Source setup: to use ROS2 you need to source it and the best option is to add

  `source /opt/ros/humble/setup.bash`

  at the end of your .bashrc


### Install pigpio
     
   ```
   wget https://github.com/joan2937/pigpio/archive/master.zip
   unzip master.zip
   cd pigpio-master
   make
   sudo make install
   ```
   __Enable and start pigpio daemon on boot__

   ```
   sudo cp util/pigpiod.service /etc/systemd/system
   sudo cp /usr/local/bin/pigpiod /usr/bin/pigpiod
   sudo systemctl start pigpiod
   sudo systemctl enable pigpiod
   ```
   
### Clone this repository

### Build this package

### Source this package

### Test
